{% extends "base.html" %}
{% set title = 'Administration Panel' %}
{% block container %}

<style type="text/css">
    .row > div{
        margin-bottom: 10px;
    }
    .header{
        min-height: auto;
    }
    .header{
        background: #FFFFFF;
    }
    .sidebar{
        background: #FFFFFF;
    }
    .content{
        background: #FFFFFF;
    }
    .sidebar, .content{
        min-height: 300px;
    }
    .btn-edit-user, .btn-del-user, .btn-create-user{
        border-width: 0.5px;
    }
    .btn-edit-admin, .btn-del-admin, .btn-create-admin{
        border-width: 0.5px;
    }
    .open-create-user .submit-create-user, .submit-update-user{}
    .open-create-admin .submit-create-admin, .submit-update-admin{}
</style>

<script src="{{ url_for('static', filename='js/admin.js') }}?ver=001"></script>
<script src="{{ url_for('static', filename='js/user.js') }}?ver=001"></script>

<div class="mybs">
<ul class="nav nav-tabs">
    <li class="active"><a data-toggle="tab" href="#users_panel">Users</a></li>
    <li><a data-toggle="tab" href="#containers_panel">Containers</a></li>
    <li><a data-toggle="tab" href="#admins_panel">Administrators</a></li>
</ul>
</div>

<div class="tab-content">
<div id="users_panel" class="mybs tab-pane in active">
    <div class="row">
        <div class="col-sm-12">
            <div class="page-header">
                <h2>Users</h2>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <div class="content">
                <table class="table table-striped table-hover">
                    <thead>
                    <tr>
                        <th>Mode</th>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Notebook URL</th>
                        <th>Container Name</th>
                        <th>Status</th>
                        <th>Last Updated</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for user in users %}
                    <tr>
                        <td>
                            <div class="btn-group btn-group-xs">
                                <button class="btn btn-default btn-xs btn-edit-user" data-toggle="modal" data-target="#update-user-modal" data-title="Update User" data-uname="{{ user.name }}" data-cid="{{ user.container_id }}" data-curl="{{ user.notebook_url }}" data-desc="{{ user.description }}" data-url="{{ url_for('user', name=user.name) }}" data-password="{{ user.password_hash }}">Edit</button>
                                <button class="btn btn-default btn-xs btn-del-user" data-url="{{ url_for('user', name=user.name) }}">Delete</button>
                            </div>
                        </td>
                        <td><a href={{ user.uri }}><strong>{{ user.name }}</strong></a></td>
                        <td>{{ user.description }}</td>
                        {% if user.notebook_url %}
                        <td><a href={{ user.notebook_url }}>{{ user.notebook_url }}</a></td>
                        {% else %}
                        <td>{{ user.notebook_url }}</td>
                        {% endif %}
                        {% if user.container_name %}
                        <td><a href={{ url_for('container', name=user.container_name) }}><tt>{{ user.container_name }}</tt></a></td>
                        {% else %}
                        <td><tt>{{ user.container_name }}</tt></td>
                        {% endif %}
                        <td>{{ user.container_status }}</td>
                        <td><tt>{{ user.timestamp }}</tt></td>
                    </tr>
                    {% endfor %}
                    <td colspan=7><button class="btn btn-default btn-xs btn-create-user open-create-user" data-url="{{ url_for('users') }}" data-toggle="modal" data-target="#create-user-modal" data-title="Create User">Create New User</button></td>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div id="containers_panel" class="mybs tab-pane">
    <div class="row">
        <div class="col-sm-12">
            <div class="page-header">
                <h2>Containers</h2>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <div class="content">
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>ID</th>
                            <th>Status</th>
                            <th>URL</th>
                            <th>Image</th>
                            <th>Uptime</th>
                            <th>Owner</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for container in containers %}
                    <tr>
                        <td><a href="{{ url_for('container', name=container.name) }}">{{ container.name }}</a></td>
                        <td>{{ container.shortid }}</td>
                        <td>{{ container.status }}</td>
                        {% if container.notebook_url %}
                        <td><a href="{{ container.notebook_url }}">{{ container.notebook_url }}</a></td>
                        {% else %}
                        <td>--</td>
                        {% endif %}
                        <td>{{ container.image }}</td>
                        <td>{{ container.uptime }}</td>
                        <td>{{ container.owner }}</td>
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div id="admins_panel" class="mybs tab-pane">
    <div class="row">
        <div class="col-sm-12">
            <div class="page-header">
                <h2>Administrators</h2>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Mode</th>
                        <th>Name</th>
                        <th>E-mail</th>
                        <th>Last Updated</th>
                    </tr>
                </thead>
                <tbody>
                    {% for admin in admins %}
                    <tr>
                        <td>
                            <div class="btn-group btn-group-xs">
                                <button class="btn btn-default btn-xs btn-edit-admin" data-url="{{ url_for('u_admin') }}" data-toggle="modal" data-target="#update-admin-modal" data-title="Update Admin" data-email="{{ admin.email }}" data-nickname="{{ admin.nickname }}">Edit</button>
                                <button class="btn btn-default btn-xs btn-del-admin" data-url="{{ url_for('u_admin') }}" data-nickname="{{ admin.nickname }}">Delete</button>
                            </div>
                        </td>
                        <td>{{ admin.nickname }}</td>
                        <td>{{ admin.email }}</td>
                        <td>{{ admin.timestamp }}</td>
                    </tr>
                    {% endfor %}
                    <td colspan=4><button class="btn btn-default btn-xs btn-create-admin open-create-admin" data-url="{{ url_for('u_admin') }}" data-toggle="modal" data-target="#create-admin-modal" data-title="Create Admin">Create New Admin</button></td>
                </tbody>
            </table>
        </div>
    </div>
</div>
</div> <!-- tab-content -->

{% include 'update-user-modal.html' %}

<div id="update-admin-modal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Admin Configuration</h4>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <label for="nickname" class="control-label">Admin Name:</label>
                        <input type="text" class="form-control" id="nickname" readonly>
                    </div>

                    <div class="form-group">
                        <label for="password" class="control-label">Password:</label>
                        <input type="password" class="form-control" id="password">
                    </div>

                    <div class="form-group">
                        <label for="email" class="control-label">E-mail:</label>
                        <input type="email" class="form-control" id="email">
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary submit-update-admin">Update</button>
            </div>
        </div>
    </div>
</div> <!-- update-admin-modal -->

<div id="create-user-modal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">User Configuration</h4>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <label for="new_username" class="control-label">Username:</label>
                        <input type="text" class="form-control" id="new_username">
                    </div>

                    <div class="form-group">
                        <label for="new-password" class="control-label">Password:</label>
                        <input type="password" class="form-control" id="new-password">
                    </div>

                    <div class="form-group">
                        <label for="new_description" class="control-label">Description:</label>
                        <input type="text" class="form-control" id="new_description">
                    </div>

                    <div class="form-group">
                        <label for="new_container_id" class="control-label">Container ID:</label>
                        <input type="text" class="form-control" id="new_container_id">
                    </div>

                    <div class="form-group">
                        <label for="new_server_url" class="control-label">Server URL:</label>
                        <input type="text" class="form-control" id="new_server_url">
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary submit-create-user">Create</button>
            </div>
        </div>
    </div>
</div> <!-- create-user-modal -->

<div id="create-admin-modal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Admin Configuration</h4>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <label for="new_nickname" class="control-label">Admin Name:</label>
                        <input type="text" class="form-control" id="new_nickname">
                    </div>

                    <div class="form-group">
                        <label for="new_password" class="control-label">Password:</label>
                        <input type="password" class="form-control" id="new_password">
                    </div>

                    <div class="form-group">
                        <label for="new_email" class="control-label">E-mail:</label>
                        <input type="email" class="form-control" id="new_email">
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary submit-create-admin">Create</button>
            </div>
        </div>
    </div>
</div> <!-- create-admin-modal -->

{% endblock %}
